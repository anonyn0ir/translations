---
title: Cover - REKT
date: 29 декабря 2020
rekt: 
  количество: 9400000
  аудит: Arcadia Group
  дата: 29 декабря 2020
tags:
  - cover
  - Rekt
excerpt: В следующий раз не лезь не в свое дело. Гора монет растет, но Вилли Вонка ни при чем - это классический голливудский нуар со страховым сюжетом. Черно-белые доходы со страховых полисов очень хорошо ложатся на сюжетные линии Голливуда.
banner: https://lh4.googleusercontent.com/IgAdM7JctrErxRd1kLmyJz4CEUbBDH1xZdsE4h7YZ_6NTRmWbF3p7rNREX-4BcKiTRH9FygNeZXSOzLCe2PqmVZ2NrWz5fb6ZKpPREHc4x3zsCoF8RcQvhj9Sx5XlBDiM04p1Xnh
---

![](https://lh4.googleusercontent.com/IgAdM7JctrErxRd1kLmyJz4CEUbBDH1xZdsE4h7YZ_6NTRmWbF3p7rNREX-4BcKiTRH9FygNeZXSOzLCe2PqmVZ2NrWz5fb6ZKpPREHc4x3zsCoF8RcQvhj9Sx5XlBDiM04p1Xnh)
**В следующий раз не лезь не в свое дело.**

Гора монет растет, но Вилли Вонка ни при чем - это классический голливудский нуар со страховым сюжетом. 

Черно-белые доходы со страховых полисов очень хорошо ложатся на сюжетные линии Голливуда.

**В фильме [Двойная страховка](https://www.youtube.com/watch?v=yKrrAa2o9Eg) (1944), страховая премия стала движущей силой добра и зла.**

Название фильма воспроизводит пункт из страхового полиса, гарантирующий двойные выплаты, если застрахованный умирает из-за несчастного случая.

История выливается в закрученный сюжет, в котором страховой агент оказывается втянут в преступную схему своей любовницей. Она хочет, чтобы он убил ее мужа и выдал убийство за несчастный случай, чтобы получить выплату по страховке.

**Никогда ничего не принимайте за чистую монету.** Сюжетные линии в DeFi редко бывают прямыми. Анонимность и компонуемость создают идеальную почву для конспираций; есть много способов воспользоваться одним и тем же инцидентом, а это значит, что умные игроки не всегда получают самую очевидную награду. 

**$9.4М украдено, $3.2М удалось вернуть и $6.2М потеряны.**

**COVER (ранее известный под названием SAFE) обвалился на ~[90%](https://www.coingecko.com/en/coins/cover-protocol) когда уязвимость, позволяющая чеканить до бесконечности была обнаружена и подверглась эксплоиту.** В результате общий запас токенов вырос на 48 квадриллионов процентов, с 84,477 до 40,796,131,214,802,600,000.

Шесть разных адресов чеканили монеты COVER через эту дыру, пока ее не закрыли. **Кому-то удалось сохранить деньги, остальным - нет.**

Из этих шести адресов, воспользовавшихся лазейкой, наибольшее внимание привлек ранее [неизвестный](https://medium.com/@grap.finance)[Grap Finance](https://etherscan.io/token/0xC8D2AB2a6FdEbC25432E54941cb85b55b9f152dB). Они не упустили шанс назваться “Белыми шляпами”, продавая отчеканенные COVER за ETH и возмещая их с дерзкими приписками.

**Код есть закон, но уязвимости никуда не деваются** - можно не беспокоиться, хакеры ими воспользуются. Но мы знаем, что все всегда не так просто, как кажется.

У кого страховка покрывала $COVER? Мы воспользовались прикрытием, чтобы выяснить это.
![](https://lh3.googleusercontent.com/StXzSYZ9O3fWgBSfhG1AUgJwfNlHvh20UIr03MSxmDW94rKhJfr9VJnyjxUyRAhgxAmGY7yeVnqokpMW3rk6ZzpZOB0bQuDCTxMzRAlParXEr6lNlN_WkI_xHSo6hxk5ul1n9D5y)

**Отдел Безопасности REKT**

В оригинале атака состояла из [четырех шагов](https://twitter.com/vasa_develop/status/1343571127331737600?s=20) и одного атакующего, но все усложнилось, когда уязвимость [обнародовали](https://twitter.com/Luciano_vPEPO/status/1343509612583145472?s=20), и другие кошельки скопировали процесс.

Следующая хронология взята из официального [постмортема Cover](https://coverprotocol.medium.com/12-28-post-mortem-34c5f9f718d4). Мы предлагаем вам подробный [пошаговый](https://www.notion.so/Cover-Infinite-Mint-Exploit-0a234cc279484982ae559bb5ab54532a#6359c6970a1b414499b76241a7e7b967) анализ от [@vasa_dev](https://twitter.com/vasa_develop).

**Хронология эксплоитера №1**

28–Дек-2020 04:09:27 +UTC

- **Новый пул [Balancer](https://etherscan.io/address/0x59686e01aa841f622a43688153062c2f24f8fded) был добавлен в контракт Blacksmith** через мультисиг команды, используя [транзакцию](https://etherscan.io/tx/0xe5173fffaed3342b53d41319dc538e7923e287e962df2d27f5e425c633db45d4), связанную с новыми сроками истечения действия страховки.

28–Дек-2020 08:08:12 +UTC

- **Атакующий [выполняет](https://etherscan.io/tx/0xd721b0ef2886f14b75548b70d2d1fd82bea085ca24f5de29b833a64cfd8f7a50) первый депозит в контракт** в размере 1,326,880 токенов BPT

28–Дек-2020 08:11:16 +UTC

- **Следом тот же атакующий затем [выполняет](https://etherscan.io/tx/0xadf27f5dd052482d46fdf69a5208a27cc7352522c7c19bbde5aee18f6ea4373b) вывод(),** извлекая из контракта ~703.64 $COVER и выводит 1,326,878.99 BPT

28–Дек-2020 08:47:15 +UTC

- **Первую продажу $COVER из эксплоита можно найти [здесь](https://etherscan.io/tx/0x66128a1685605b1798c852e14db0b0232a56e3bebf7f3f35b168642801754beb).** В течение всего этого времени множество аккаунтов использовали эксплоит и продавали свои $COVER на рынке.

28–Дек-2020 09:18:28 +UTC

- **Атакующий [продолжает чеканить](https://etherscan.io/tx/0xf81fb72ee096e0d7afe4b99a55b723110604fb26ec82846043cfc396e1fa79da),** пока вектор атаки все еще доступен.

**В сумме, эксплоитер №1 украл примерно $4.4 миллионов пользовательских денег и перевел их на этот [адрес](https://etherscan.io/address/0x85abf036ca922e56fed670f4d3ce53fc4ea52b95#tokentxns).**

Похоже, что поначалу уязвимость обнаружили случайно. У эксплоитера №1 оказалась плохая служба безопасности, обычный кошелек, снабжаемый через обменник с KYC и с 3-летней трейдинговой историей. Кто-то заявил, что знает эксплоитера, и предложил ему [вернуть](https://twitter.com/0xRevert/status/1343743516544028672?s=20) деньги.

---

**По классике жанра DeFi хакер, который все это затеял, привлек не так много внимания по сравнению в Grap Finance, которые воспользовались случаем и выдали себя за этичных хакеров.**

**Хронология Grap Finance**

28–Дек-2020 11:54:47 +UTC

- **[Grap Finance: Deployer](https://etherscan.io/address/0x00007569643bc1709561ec2e86f385df3759e5dd) (внешняя учетная запись) [сделал депозит](https://etherscan.io/tx/0x77490baee41a9b35a6e87d49453c7329c7517c10ce6ce26b4c142692a2877e65) 15,255.552810089260015362 BPT (пул DAI/Basis)** в фарминговый контракт Blacksmith.

28–Дек-2020 11:58:04 +UTC

- **[Grap Finance: Deployer](https://etherscan.io/address/0x00007569643bc1709561ec2e86f385df3759e5dd)  [вывел](https://etherscan.io/tx/0x88ce99fc1cb695db82d83ce5fe587396744841d3a123687f95b18df6a3106818) свои 15,255.552810089260015361 BPT** (пул DAI/Basis), оставив лишь 1 wei на своем счету в фарминговом контракте Blacksmith.

28–Дек-2020 11:58:56 +UTC

- **[Другой пользователь](https://etherscan.io/address/0xdf1aefb979d180b4d67cca9abb4c5108c89dc8a4) [вывел](https://etherscan.io/tx/0xa27fb73caddb1cf24aa7a5afe84eed13db2f0a889a6ee0f3d5e6226a76c0fd9c) большую часть всего своего баланса (1,007.599009946121991627 BPT)** из Blacksmith. Теперь Grap Finance принадлежит вся ликвидность пула DAI/Basis в контракте Shield Mining Blacksmith, а именно 1 wei.

28–Дек-2020 12:00:21 +UTC

- **[Grap Finance: Deployer](https://etherscan.io/address/0x00007569643bc1709561ec2e86f385df3759e5dd)  [вернул](https://etherscan.io/tx/0xbd1fcda7006ddd58b18cb3bfbd01ef2d1a979be596e1c73be1d7d65fd7eb8215) 15,255.552810089260015361 BPT** (пул DAI/Basis) в фарминговый контракт Blacksmith.

28–Дек-2020 12:02:04 +UTC

- **[Grap Finance: Deployer](https://etherscan.io/address/0x00007569643bc1709561ec2e86f385df3759e5dd)  [сделал запрос](https://etherscan.io/tx/0xca135d1c4268d6354a019b66946d4fbe4de6f7ddf0ff56389a5cc2ba695b035f) вознаграждения** и, по той причине, что на счету остался только 1 wei, в комбинации с ошибкой хранилище/память это привело к чеканке 40,796,131,214,802,500,000.212114436030863813 монет $COVER.

28–Дек-2020 12:29:03 +UTC

- **[Grap Finance: Deployer](https://etherscan.io/address/0x00007569643bc1709561ec2e86f385df3759e5dd) начал [продавать](https://etherscan.io/tx/0xaf94d9b537a13819e873b37160594af2b1cc70b420d0b160a02e341566866a6b) [столько](https://etherscan.io/tx/0x01b3517845ed9c6b7b40d57bd71ac1a89fec080c5b8988f764d8226ac5caa959), сколько было возможно** через 1inch.exchange через множетсво транзакций.

Dec-28–2020 12:59:27 PM +UTC

- **[Grap Finance: Deployer](https://etherscan.io/address/0x00007569643bc1709561ec2e86f385df3759e5dd) [сжег](https://etherscan.io/tx/0xe6c068ca3605228b2435a414f2b372057340f77d3fe9f1d3967eb1ad128cb5d2) начеканенные монеты.**

28–Дек-2020 13:41:01 +UTC

- **[Grap Finance: Deployer](https://etherscan.io/address/0x00007569643bc1709561ec2e86f385df3759e5dd) посылает 4351 ([1](https://etherscan.io/tx/0x23cb9bdf14eed955a84da3f3cfcf296356c0f897dec0b99e85151a7f084a3051) + [4350](https://etherscan.io/tx/0xc2fd5094c1e108f83222a86bd46b35fc0da35616385d681964b22003643f982e)) ETH, полученных от продажи $COVER на счет deployer**, на который пришлось 34% всего ущерба от эксплоита ($9.4 миллионов).

---

**Покрытие от Cover**

![](https://raw.githubusercontent.com/RektHQ/Assets/main/images/2020/12/image-4.png)

**Протоколу Cover понадобилось шесть часов для того, чтобы публично признать атаку.**

_Команда до сих пор расследует этот инцидент. Возможность для эксплоита закрыта._

_Пожалуйста, НЕ покупайте токены_ _[$COVER\_](https://twitter.com/search?q=%24COVER&src=cashtag_click) _и выведите вашу ликвидность из пула COVER/ETH на sushiswap._

_Пулы CLAIM/NOCLAIM на balancer не были затронуты_

**Спустя восемь часов после атаки, протокол** [**объявил**](https://twitter.com/CoverProtocol/status/1343581331448586245?s=20)\***что планирует возместить ущерб пострадавшим пользователям.**

_Приветствуем вас, мы собираемся ввести НОВЫЙ токен_ _[$COVER_](https://twitter.com/search?q=%24COVER&src=cashtag_click) _через снэпшот, предшествующий моменту эксплоита чеканки. 4350 EHT, которые были возвращены хакером, также будут переданы через снэпшот провайдерам ликвидности и держателям токенов. Мы продолжаем расследование. НЕ покупайте COVER_

**«То, что мертво, не может умереть.» Нигде это так не актуально, как в DeFi.** Для возмещения средств пострадавшим пользователям будет выпущена четвертая итерация протокола Cover.

SAFE - SAFE2 - COVER - _$RECOVER?_

**Настойчивость хороша до определенного момента, но когда слишком - это уже слишком?**

Некоторые читатели вспомнят полную историю протокола Cover, который стал [ребрендингом](https://coverprotocol.medium.com/cover-protocol-e202808aa4ef) протокола SAFE после того, как @azeemfi и @chefcoverage приняли неправильное решение. Онии тогда запустили SAFE2, который мигрировал в COVER, который нам известен сегодня.

Захочет ли сообщество дать им ЧЕТВЁРТЫЙ шанс?

---

![](https://lh5.googleusercontent.com/Ogj1lycooZFZrO1GfU4lgsis5tJ2j76L2BHPQ50TC3KuG7mTx_CQ-FcD90AfAQtSQqdc0ERGK95wczwmRdoznGUR9c00f381m3DAhRZp7Ego0j6U4WrxohU-RCMNtE0Sq0c4f55u)

**[Grap Finance](https://medium.com/@grap.finance) это форк проекта YAM**. Они не смогли написать ничего стоящего за лето DeFi, и воспользовались возможностью привлечь внимание, выдав себя за Белые Шляпы. Это принесло им тысячи подписчиков всего за один день.

Что они будут делать с этой новой возможностью, время покажет. 

Благодаря такой неожиданной активности **Grap Finance** вошли в пятерку Dapps, изменивших состояние счета Cover за последние 7 дней.
![](https://lh3.googleusercontent.com/FMvU_UZhki6SB0ery4HcON4MEfMbBSPmrah0QDGPCqgwePElvreCDCKdVct9Mo2-B2sqqgUqx8y4MQOpJIPMtn-VqI4tm3ND37FW_Kyz0sDVWKDvdmyBZpe555KyeVqpQd2hO6by)

Говорят, что плохая реклама не существует, и это, кажется, подтверждается нижеследующим графиком. 1778 новых уникальных адресов подключились к COVER в день атаки. Трейдеры-оппортунисты попытались перехватить занесенный нож.
![](https://lh5.googleusercontent.com/n3eflB7D7s60xY-dZg_755bKnUbm-8XEpryBbapuAY1UhlCirnheGGcmDL8hX6Bv8im6TzNFOBryHjcrGL9bUPcMShVRB-wepJfTxod4M71KiL-15n9qdBhjJPRPCzuqe62ixMFZ)
На этом графике видно, что Binance в зеленом секторе из-за огромного притока депозитов COVER, так как сообщество пыталось покинуть тонущий корабль до того, как трейдинг токена остановили.
![](https://lh4.googleusercontent.com/ISdelPif5XcLBEWb4fNDHyOanmb9rPv5Ny47vHbshuH0bevewfDrt6Agt28yYWRiSgxUFSC_NPPX_Vp5oJOWFkCeXByfFP9pO07HniqwKcBtNeBgwCrJNKyepBp22XVFgxQeFyQB)
Ответственное поведение не приносит много денег, но за грехи мы всегда платим сполна.

Говорят, что это был неудавшийся инсайдерский эксплоит.

Возможно, атакующего раскрыли, он не смог сохранить деньги, поэтому вернул их и вместо этого воспользовался рекламой.
![](https://lh5.googleusercontent.com/8DTMgDPJE8_EL2ldg9LTM8_A4JtUw1oAbAIxFcZj3MOISWVwa5Do7EivF7R5SrcInzstS7lLnHYlA3Sug4uqC95aE_EAZdNOwIeD_QQvB5F9ckPTFrotVFZ2I02JaPT-Gb_J6MwY)
**Мы не утверждаем, что у этих слухов есть основание, но трудно не заметить, как много таких идей появляется, когда случившееся приводит к [таким](https://support.mxc-exchange.com/hc/en-001/articles/360054776091) заявлениям.**
![](https://lh3.googleusercontent.com/LJ9XZzZF2hn1qinb-EP8NlGS3vK2QdGWllXXAgmYbHxVCGKF-B07NHSyXREHg7smGNDfyITiFgf7txfb0Eejrn-AVycPUzhnjTFV0dv7hD0Sqmfk_gHEUlonGnnc7J_qGLuzGhce)

**О случайном совпадении не может быть и речи,** это либо грязная игра, либо акт отчаяния. Должно быть, дела у MXC идут совсем плохо, если они делают листинг токенов, основываясь на слухах.

Крипто-тусовка Твиттера доказала, что аппетит на риск у нее по-прежнему высокий, накачав цену [токена](https://www.coingecko.com/en/coins/grap-finance) своего «спасителя»  на несколько тысяч процентов, что увеличило объем его суточной торговли с $236 до $5,458,084 в то время, как мы пишем эту статью.

---

**Emiliano Bonassi сказал следующее:**

_Если не брать в расчет техническую проблему, этот случай снова показал, насколько эта экосистема  сплоченная и солидарная._

_Мы антихрупкие._

_Я уверен, что после этого события появится не только новый Cover. Что более важно, появится новый супер-реактивный коллектив, который будет гарантировать безопасность экосистемы. Возможно, Команда Этичных Хакеров._

---

**Кровь дорого обходится. Страховой рынок DeFi находится в плачевном состоянии.**

Сначала [NXM](/nxm-hugh-speaks-out/) и вот теперь Cover. Не важно, пострадал ли протокол. Если мы пишем о вас статью, значит, доверие пользователей к вашему проекту уже улетучилось.

**Страхование в DeFi должно быть полностью прозрачным.** Божьему промыслу нет места в этом мире.

Небезопасные протоколы выплачивают большие премии, в то время как остальные изо всех сил стараются, чтобы вознаграждение шло за отсутствие страховых случаев.

За 4 часа цена [COVER](https://twitter.com/search?q=%24COVER&src=cashtag_click) упала в 40 раз, тогда как цена [ $GRAP](https://twitter.com/search?q=%24GRAP&src=cashtag_click) выросла в 40 раз.

**[“Прибыли не было”](https://twitter.com/GrapFinance/status/1343555258316804101?s=20) говорит команда Grap, прячась за своими экранами.**. Красивая сказка, чтобы скрыть правду.

**Белая краска быстро смывается с черных шляп под дождем обвинений.**

Расследование продолжается...

---

![](https://lh6.googleusercontent.com/p6se9Mb3aS2HWRTPsm98ZjKAwuUAel7YOOa02gjrlbP6q_iTmGLiQ21XiTm93L102-HH4pMRqgO5dDMZu5BOJOJYmJxSpg9IPRL9S7pHZTbfTksMZkuKjEZKamLrSyh-oxey40pq)
