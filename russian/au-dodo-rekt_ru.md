---
title: DODO - REKT
date: 09 марта 2021
rekt: 
  количество: 2000000
  аудит: не проводился
  дата: 09 марта 2021
tags:
   - DODO
   - REKT
excerpt: Он умер или просто пошел баиньки? Протокол DODO подвергся хакерской атаке с использованием поддельной токенной атаки, было украдено 2 миллиона долларов, но мотив остается непонятным. Одно можно сказать наверняка: не важно, кто взломал, этичный хакер или «черный». Но всего 2 миллиона долларов? Нужно попытаться получше.

banner: https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/dodo-header-twt.png
---
![](https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/dodo-header.png)
**Он умер или просто пошел баиньки? _(«dodo» в переводе с французского означает «спать», «баиньки» - прим. переводчика)_**

Протокол DODO подвергся хакерской атаке с использованием поддельной токенной атаки, было украдено 2 миллиона долларов, но мотив остается непонятным. 

Одно можно сказать наверняка: не важно, кто взломал, этичный хакер или «черный». Но всего 2 миллиона долларов? Нужно попытаться получше.

Твиттер остается самым быстрым источником новостей в DeFi - даже команда DODO узнала от [Luciano](https://twitter.com/Luciano_vPEPO/status/1369055985684381696?s=20), что их собственный пул $WCRES / $USDT опустошили, использовав фальшивые токены.

Нижеследующий анализ взят из официального релиза DODO, и мы выражаем благодарность [@samczsun](https://twitter.com/samczsun), [@tzhen](https://twitter.com/tzhen), [PeckShield](https://twitter.com/peckshield) и [SlowMist](https://twitter.com/SlowMist_Team).

![](https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/dodo-linebreak.png)

**Мишенью эксплоитов стали несколько краудпулов V2 протокола DODO, а именно WSZO, WCRES, ETHA, и пул FUSI.**

В сумме в результате этих эксплоитов было выведено $3.8 миллионов, из которых $1.88 миллионов возможно удастся вернуть (об этом мы рассказываем дальше). 

В смарт-контракте Crowdpooling протокола DODO V2 есть баг, который позволяет вызвать функцию init() много раз подряд. Это значит, что эксплоитер может осуществить атаку по следующему алгоритму:

**1.** Эксплоитер создает поддельный токен и инициализирует смарт-контракт, вызывая функцию init()

**2.** Эксплоитер вызывает функцию sync() и устанавливает «запасную» переменную, которая представляет собой баланс токенов, на значение 0.

**3.** Эксплоитер вызывает функцию init() снова, чтобы реинициализировать - на этот раз с помощью «настоящего» токена (т.е. токенов в пуле DODO)

**4.** Эксплоитер использует флэш-кредит, чтобы перевести все токены из пула и обойти проверку флэш-кредита.

![](https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/dodo-suspects.png)

**В резюме говорится, что эксплоит совершили два человека.  Назовем их Личность А и Личность Б.**

У личности Б есть все признаки фронтранингового бота, потому что он:

- Создал адрес контракта с префиксом из нескольких 0.
- Использовал газ-токен CHI
- Установил очень высокую цену на газ; в одном из случаев он поднял значение в настройках транзакции, чтобы использовать 93,148 gwei.   

В дополнение, эксплоиты Личности Б опередили удачные эксплоиты Личности А на целых 10 минут.

**Личность А**

[Личность A](https://etherscan.io/address/0x368a6558255bccac517da5106647d8182c571b23) уже связалась с командой DODO через samczsun и предложила вернуть им фонды, которые вывела из их пулов.   Вот подробный отчет о действиях Личности А:

>Личность А взаимодействовала с централизованной биржей.

Личность A [вывела](https://etherscan.io/tx/0x970b32a8c81dd3fc47fa118621726fc418ec3526c4379470a4000ed7b448360f) 0.46597 ETH с Binance:  

Личность A [выполнила](https://etherscan.io/tx/0x300de107cbca466abe121112848daaf7f5f0d15625d54773dd0bbbff4e276e93), в быстрой последовательности 7 транзакций по выводу BUSD (один из примеров по ссылке), возможно, с использованием Binance Bridge: 

>Личность А перевела свои фонды на адрес другого кошелька.

Личность А перевела 67,416 BUSD на адрес 0xa305fab8bda7e1638235b054889b3217441dd645 дважды: [ОДИН](https://etherscan.io/tx/0x306d08f3d8af85dfdea7a6edb336d7504e8ecc7c609e4b940d188ba68e11cab5) - [ДВА](https://etherscan.io/tx/0x56dbf6421c6e6bd779ab0c12fd49e1f7714dd85023aa74abae1940f8d88669cf)

Личность А перевела 59,245.324743 USDT на адрес 0xa305fab8bda7e1638235b054889b3217441dd645 дважды: [ОДИН](https://etherscan.io/tx/0xbee2f507b2f4b4321927a9762dac757df12fe1ba2d6f85314273b9ea542a5c13) - [ДВА](https://etherscan.com/tx/0xaf80cf58c88f0e0f2f44e3902e4c7cd2c17122511fbc6c2d9b2cd43fbc4199b9)

Личность А выполнила два эксплоита против смарт-контрактов DODO.

Первый против тестового контракта DODO-USDT, деньги были [переведены](https://etherscan.io/address/0x328410f276d4fe83fc78fa56ad32d9821a5e5c1c#tokentxns) на адрес 0xa305fab8bda7e1638235b054889b3217441dd645. 

Второй против контракта WCRES-USDT, деньги были [переведены](https://etherscan.com/address/0x910fd17b9bfc42a6eea822912f036ef5a080be8a#tokentxns) на адрес 0x56178a0d5f301baf6cf3e1cd53d9863437345bf9.

**Сейчас деньги находятся на этих двух адресах:**

[0xa305fab8bda7e1638235b054889b3217441dd645](https://etherscan.io/address/0xa305fab8bda7e1638235b054889b3217441dd645)

[0x56178a0d5f301baf6cf3e1cd53d9863437345bf9](https://etherscan.io/address/0x56178a0d5f301baf6cf3e1cd53d9863437345bf9) 

**Личность Б**

Личность Б скорее всего бот. _(dodo-робот)_

**Подозреваемый смарт-контракт бота:** 0x00000000e84f2bbdfb129ed6e495c7f879f3e634 

**Адрес триггерного аккаунта:** 0x3554187576ec863af63eea81d25fbf6d3f3f13fc

**Личность Б выполнила 3 эксплоита против смарт-контрактов DODO:**

**ETHA-USDT:** [0x0b062361e16a2ea0942cc1b4462b6584208c8c864609ff73aaa640aaa2d92428](https://etherscan.io/tx/0x0b062361e16a2ea0942cc1b4462b6584208c8c864609ff73aaa640aaa2d92428)

**WSZO-USDT:** [0xff9b3b2cb09d149762fcffc56ef71362bec1ef6a7d68727155c2d68f395ac1e8](https://etherscan.io/tx/0xff9b3b2cb09d149762fcffc56ef71362bec1ef6a7d68727155c2d68f395ac1e8)

**vETH-WETH, где использовалось 93,148 gwei:** [0x561f7ccb27b9928df33fa97c2fb99ea3750593e908f9f0f8baf22ec7ca0c5c4a](https://etherscan.io/tx/0x561f7ccb27b9928df33fa97c2fb99ea3750593e908f9f0f8baf22ec7ca0c5c4a)

**Сейчас деньги находятся на этих двух адресах:**

[0x00000000e84f2bbdfb129ed6e495c7f879f3e634](https://etherscan.io/address/0x00000000e84f2bbdfb129ed6e495c7f879f3e634)

[0x3554187576ec863af63eea81d25fbf6d3f3f13fc](https://etherscan.io/address/0x3554187576ec863af63eea81d25fbf6d3f3f13fc) 

Сейчас команда DODO пытается связаться с владельцами этого адреса.

![](https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/dodo-linebreak2.png)

**Анонимный игрок украл сравнительно маленькую сумму в $2 миллиона.** 

Очень похоже на то, что цвет шляпы меняется в зависимости от того, какую сумму можно украсть. 

>Маленькая сумма = белая шляпа и хайп - Большая сумма = забирай и прибавляй к остальным миллионам.

**Можем себе только представить личные богатства, которые эти личности копят.** Там столько же возможностей, и не только для тех, кто решил научиться кодированию.

Отдельного внимания заслуживает тот факт, что команды полагаются на Твиттер, чтобы узнавать новости о своих собственных протоколах. Этот инцидент служит напоминанием, что мы все еще находимся на ранней стадии развития индустрии.

>С возможностью сделать себе имя все ясно. А что вы будете делать с властью - дело ваше. 

![](https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/dodo-conc.png)

Источник изображений: [harrikallio.com](https://harrikallio.com/portfolio/dodo-mauritius-island/) & [@BxST23](https://twitter.com/BxST23) 
