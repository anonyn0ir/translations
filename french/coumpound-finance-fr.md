---
title: Compounder Finance - REKT
date: 02 Dec 2020
rekt: 
  amount: 12000000
  audit: Solidity Finance
  date: 02 Dec 2020
tags:
  - c3pr
  - audit
  - rugpull
excerpt: La Faucheuse rekt sait s’y prendre pour faire parler les gens. Dans les derniers instants, alors que la TVL approche de zéro, et que le désastre économique devient insupportable, une figure sans visage entre dans le chat.

banner: https://lh6.googleusercontent.com/TLkLMvzALcncoyVu5MGEumqmlOqk7KWADtRJ8Uj62TXUWi_SZg_gw9iiF9hVi_vgMp55Jvpy5Bl0d_ZxOcmJfZnEALbmRDkcrfbNPaO3F4b-qsIEjOfU3Tp4bKk54JN2wzTCVDhE
---

![](https://lh6.googleusercontent.com/TLkLMvzALcncoyVu5MGEumqmlOqk7KWADtRJ8Uj62TXUWi_SZg_gw9iiF9hVi_vgMp55Jvpy5Bl0d_ZxOcmJfZnEALbmRDkcrfbNPaO3F4b-qsIEjOfU3Tp4bKk54JN2wzTCVDhE)

**La Faucheuse rekt sait s’y prendre pour faire parler les gens.**

Dans les derniers instants, alors que la TVL approche de zéro, et que le désastre économique devient insupportable, une figure sans visage entre dans le chat. 

Lorsqu’un protocole est mortellement blessé, et qu‘il est temps de préparer ses linges mortuaires, le quatrième et dernier cavalier de l’Apocalypse arrive pour le guider vers la vie après la mort, se présentant lui-même sous le format en .gif.

**[Compounder.finance](http://compounder.finance/) a été rugpull pour plus de 12,000,000 $.**

Dans notre communauté instable, la cupidité et le désespoir sont punis et récompensés de manière égale mais imprévisible.

Ici, il y a de l'espoir pour le pécheur, dont les transgressions sont oubliées dès que celui-ci s’échappe de la blockchain en revêtant sa cape d’anonymat.

Rekt est là pour offrir aux pécheurs une opportunité de confession publique - pour dévoiler leurs méthodes afin que nous puissions _tous_ apprendre.

**Le site compounder.finance et son compte Twitter ont été supprimés instantanément.**

**La seule piste offerte à nos détectives fut un audit de sécurité réalisé en entier.**

Il y a beaucoup de travail au [RektHQ](https://twitter.com/RektHQ), et à peine quelques heures s'étaient écoulées lorsque nous avons commencé à enquêter… Lorsque nous avons contacté les auditeurs pour discuter, ils n'étaient pas très contents de nous voir.

![](https://lh4.googleusercontent.com/j_yn7CTMvy6RhjtNHFw7jRwsT0Eossl9zY3lzlm5Uq-hxz2AE-V1Zf97vT11BfwAU-HH1YVRhIEfA6YqwHpDAaSA_dVNpY_VoSvGcUgGXyRdHVVqVOX03YWiJ1AWkK48OKTX6Nsf)

> **_S’il vous plaît ne nous envoyez pas des trucs morbides comme ça, j’ai vraiment eu peur pour ma sécurité pendant une minute, et des gars plus fragiles pourraient report ça ou faire d’autres trucs dans ce genre._**

Après que nos enquêteurs les ont rassurés, Solidity.finance nous a fourni [l'historique entier](https://solidity.finance/audits/CP3R/ChatLogs.pdf) du chat de leur conversation avec compounder.finance.

![](https://lh6.googleusercontent.com/jmSOsLERtND5cPjpj5zRKXEsyPg-vqXNGixs02ru1ZYLSMTjxSN4S8ZtDflMFHiI4ImG7ou-B6XA6P201hR94CjS09-Pk7rVkQ2WR4mu0u8SIpjnXx2FPXr99UBJMc8phplKmMlk)

D'autres victimes nous ont également contactés, partageant leurs premières conversations avec les admins de compounder où ils exprimaient déjà leur inquiétude. 

![](https://lh5.googleusercontent.com/-wS-a_Bpwg90_-BScXqJTSVhYm1nsNF2WyFBwrTUUslw-wy4eYm_t2cb0LUCwny5jLWGmfJZNN6uDQxSkcbJVOakKBpJJMjXaWr9mLxrhxxFkm_SY_gWUfFq15bg3TUft-UlUBsl)

Solidity.finance nous ont dit n’avoir parlé que brièvement avec les admins, et bien qu’ils aient en effet audité le contrat, ils concluent dans leur document que même si les trésoreries des pools étaient contrôlées par un timelock, celle-ci n’offrait en réalité aucune protection.

Le message suivant provient de leur copie du chat :

![](https://raw.githubusercontent.com/RektHQ/Assets/main/images/2020/12/image.png)

À ce stade de notre enquête, solidity.finance restait suspect. Nous voulions savoir pourquoi ils avaient cru que l'équipe de compounder.finance était apparemment "vraiment digne de confiance".

![](https://lh3.googleusercontent.com/zAnDE5lhy4th23b04O90LfyMOzuZNKVQpGJSbvm1l9nyik3ALWHNN9w2ESpA9vVgbhUr4mG8RKoWHJs9vA-xxlg5tSHWy0cdYedy26u46htRO2F6DM6ueioCBHkqYyA336fkbeNY)

![](https://lh4.googleusercontent.com/3cTLMXUqzGK79tC0tquzA-fJHOgDMyfrNrJywsKGRyCvSNUPI6C097QgqvUeOBASoWAnvVnx4GGcYpkJgD2rHxcrc9uBkkoToqtqzn1DNBOlmBmk6gP-ueO1kwfyQtYjfYerCmsK)

En lisant la copie du chat, nous avons remarqué que bien que les comptes aient été supprimés, il restait un nom d’utilisateur - “keccak”.

![](https://raw.githubusercontent.com/RektHQ/Assets/main/images/2020/12/image-1.png)
![](https://lh6.googleusercontent.com/2Rer5ONASpGduNUGsKPIG7WjVnvSk0qldLQC3qKVl1GaC8H9eTkAEuwRxApHZV1-eRNs4z18n2lRWjM9_aKDwDjunZPqkUIn2cUh1APe3MTSUnpjhd1YkInL0NMzc9L391CWpNtN)

Bien que solidity.finance ait déclaré que keccak avait supprimé son compte, nous avions déjà trouvé son compte et tenté de le contacter.

![](https://lh4.googleusercontent.com/n843mEGRcOHYLt5WsOuC5CpMrwAyICOJ9Mj92qHGWjSUko2CSgUhwsRMQhTKUNj0mQnFebVnlX3GXJ9J6aEErSbqYIf0nAAjR7SargO3_dm1xuUIRiLP3mHlF23pxpMjVqZ-Bk6B)

Malheureusement, Vlad ne souhaitait pas parler au téléphone, et nous lui avons donc envoyé un message, sans vraiment s'attendre à ce qu'il réponde. 

Jusqu’à ce que…

![](https://lh6.googleusercontent.com/iCjWb4HeUCo8uB3eZLfksQFxFJdMEruvDsRzzFmwqYZcDzlXOePo-OmTAsbF1HMT89YxccN-Xs1pGl39sI8B4V4HkKx5EDMqSMxLLqiahIAcE9urNAvJUfcMbqAYSGuzEEOpnt2U)

Vlad était prêt à parler. Malheureusement, il n’était pas très coopératif.

![](https://lh6.googleusercontent.com/HE93DRIaDmYVHG4436QTGIPxZKsXJ0Ly4UXIojAKIPrpapwfQUyEJofxc4X2hZqyTwRkVnRALWfghAwR_BzCD6r0rPK1JQ-nQ5N2zpKhaLJuKVe8WYRj81PdojtL9oV9X9g4a75t)
![](https://lh5.googleusercontent.com/KnQgeeZ8ui5i0loOefPMXBmxwqOOWX0cJB9TZCWAmE9Mt1COguIZB9C8v6D3niEhzCNJuCbj68G0L5eslhSSa83M3XKpLAxSRJ-PUftnrtbN1sLy3fUCmM6JfCUYiySLc9d5wejK)

Vlad / keccak est toujours joignable sur Telegram via @keccak, mais il ne répond plus, et a depuis supprimé les images sur son compte. Nous joignons ici ses anciens avatars pour que vous ayez toutes les informations en main au cas où vous vouliez creuser l'affaire.

Nous avons été informés que - _Celui du loup est tiré d'un célèbre dessin animé ukrainien en russe, qui dit “passe donc à l’occasion”._

_Celui de gauche est une affiche anti-armes nucléaires._

Ça n'avance malheureusement pas beaucoup les utilisateurs affectés.

![](https://lh6.googleusercontent.com/-C_fEe5K7VtTZBgWbN1x0T08gdPgA644Vf_UlKT7ZpIwM8Yvg0-VF_NbIlm3B6aPfgFVcicuLn60v12XKHvN0IMPukME0JQS1wO15OBo0mG00qKujj9N8rM3dFCpkOZ5HTZVvR2q)

**Une fois qu’il était devenu évident que Vlad ne voulait pas parler, nous avons rejoint le groupe Telegram officiel  de Compounder, où il était clair que notre réputation nous précédait.**

![](https://lh6.googleusercontent.com/Bgibey9mMbZwxbZvLI3RpEsUKgqENRRGjySROwVuypAQaVeNqCnW4ZjPLOyXkLuzFDdAFs0UOXCVjeRdgZhrC3Fwaemg-0Jjfb0QSDBzvcDI_xggCXfFiRg52tqg3GwHIRQ9Qz6d)

Alors que nous scrollions à travers le fil du chat, nous avons observé tous les comportements typiques causés par un rugpull tout frais.

![](https://lh6.googleusercontent.com/3NDRvDXQyKMx7QH_4iiJs6BwoganIn8R0YE0fqk1z0MH8cRljLJwu8hUBaj_HYldnAuLBU1cP9yw6mEOuWfesjjBnhzs4UVDbZ3QjI9EWV7RdifLXikt3fy5jsB2IOoNy2dZNd9D)

**Même des gros joueurs font profil bas face au pouvoir d’un rugpull. Ce [chef de groupe](https://twitter.com/defiyield_info) a perdu 1,000,000 $ et a ouvert son propre [groupe](https://t.me/compounderopsec) d'investigation (686 membres) pour tenter de se venger.**

![](https://lh4.googleusercontent.com/NymcDlq36Hf0ZJWBbN4BDjIlBI4rHhOTYmDMYGgvSNYjFLYG_Y6VWgubCqj9FTl7_AjBfx3uji0gstUdJkec4jTgzNPZT6lqT88cEj11ZchK9X8yPaNP7YTNmmif0D2ps8pkyR8T)

Le fil peut être consulté [here](https://twitter.com/defiyield_info/status/1333731633393004545?s=20).

**Les statistiques**

Dans le cadre de notre enquête, **nous avons présenté Solidity.finance à [@vasa_develop](https://twitter.com/vasa_develop) de Stake Capital** et lui avons demandé de travailler ensemble pour créer un post-mortem complet de l'incident.

Les données suivantes sont tirées de son [rapport](http://simpleaswater.com/cp3r).

**Actifs Ruggés (8):**

- 8,077.540667 Wrapped Ether ($4,820,030.07)
- 1,300,610.936154161964594323 yearn: yCRV Vault (1,521,714.80 $)
- 0.016390153857154838 Compound (COMP) (1.79 $)
- 105,102,172.66293264 Compound USDT (2,169,782.85 $)
- 97,944,481.39815207 Compound USD Coin (2,096,403.68 $)
- 1,934.23347357 Compound Wrapped BTC (744,396.89 $)
- 23.368131489683158482 Aave Interest bearing YFI (628,650.174379401 $)
- 6,230,432.06773805 Compound Uniswap (466,378.99 $)


**Les portefeuilles avec les fonds après le rug-pull :**

- [https://etherscan.io/address/0x944f214a343025593d8d9fd2b2a6d43886fb2474](https://etherscan.io/address/0x944f214a343025593d8d9fd2b2a6d43886fb2474)
- 1,800,000 DAI
- [https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758](https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758)
- 5,066,124.665456504419940414 DAI
- 39.05381415 WBTC
- 4.38347845834390477 CP3R
- 0.004842656997849285 COMP
- 0.000007146621650034 UNI-V2
- Depuis le moment où le Deployer a été financé pour la première fois via [Tornado.cash](https://etherscan.io/tx/0x2fc406e07328e04022b555b5cab69bc932d29d1115eca3d121cbd49da90fb817) jusqu'au moment du rug pull, le Deployer a envoyé de l'ETH à 7 adresses différentes. La plupart étaient des paiements ponctuels. [Une de ces adresses](https://etherscan.io/address/0x8f332c9ffb2be270d5c1c0de3fdac3d993517593), cependant, a reçu 4 paiements séparés le 19, 20, 22 et 23 novembre. Une grande partie de ces fonds a fini sur [une autre adresse](https://etherscan.io/address/0xd6c35c1828a7062e21468768c546a64dd1be1602) détenant plus d’un million de KORE (seulement 10,000 KORE existaient avant le rug pull).

Les 7 malicious strategy contracts qui ont été ajoutés à la codebase après l'audit étaient le(s) principal(aux) coupable(s) de ce hack.

Une non-malicious withdraw() function d'un Strategy contract ressemble à quelque chose de ce genre :

![](https://lh5.googleusercontent.com/t_BQNl6cnQmq98OvUsKf63yo8N93mJWbEOimWOmpkk8RyQHiOCXnBd7Q5iNRRzXZuemKX9vQ66bysjBdZFxaSClpp_jPERv2b6rH7XDgewnUUI6GWJrMEORb7S1339TOjV7nc8uL)

Notez que nous avons des checks comme :

![](https://lh5.googleusercontent.com/ZKGym0FbW_OC44MliLLqmvMJjbr2RanORW_G8pcdXTnWby52DXxayqpkIXFeJOEtpxbRZdncWo7yzSXyyAIsRmtF1kDXh1MAPS6-LmHqyOgt3Cuh_3s0dA1nJAbzEzmmQpYip2LV)

Ces checks n’étaient pas là dans les 7 malicious strategy contracts. Cela permet  au contrôleur du contrat (qui était [contrôlé par le strategist du rug-pull](https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758)) de retirer ses actifs du Strategy contract.

(Notez les checks manquant ci-dessous dans la fonction withdraw malveillante)

![](https://lh4.googleusercontent.com/LX2pt7hp6dieDg5bU-6hMQkIFeAh9ZCABSIADVQZ62Y6OXcF6lRk6eAWuYog5Hlz2GP2_o5tNmDhbKHF0bEYr1vjHRoOPCXn03Gdq-uyiSgushapH-slIkt87Dl7BSQC5QRHw0ou)

Le rug-pull complet peut être expliqué en 4 étapes.

**Etape 1**

[Compounder.Finance: Deployer](https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758)a deployé 7 Malicious Strategies avec des fonctions withdraw() manipulées.


**Etape 2**

[Compounder.Finance: Deployer](https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758) Set et Approve 7 Malicious Strategies dans StrategyController via Timelock (24h) transactions.

**Etape 3**

[Compounder.Finance: Deployer](https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758) (strategist) called inCaseStrategyTokenGetStuck() sur StrategyController qui abuse la fonction manipulée withdraw() de la Malicious Strategies pour transférer les tokens de Strategies à StrategyController. Il le fait pour les 7 Malicious Strategies.

**Etape 4**

[Compounder.Finance: Deployer](https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758) (strategist) a call inCaseTokensGetStuck() sur  StrategyController ce qui transfère les tokens de StrategyController à l’adresse de [Compounder.Finance: Deployer](https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758) (strategist). Le [Compounder.Finance: Deployer](https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758) (strategist) a maintenant un contrôle total sur les 8 actifs qui ont une valeur de 12,464,316.329 $.

De là, les actifs ont été transférés à plusieurs adresses répertoriées [ici](https://www.notion.so/Compounder-Finance-Post-Mortem-Report-9bf6b17dc1304606bb975968039a6dc8).

**Excellent travail de la part de [@vasa_develop](https://twitter.com/vasa_develop)**.

**Si vous êtes un lanceur d’alerte, un cyberdétective ou un détective spécialisé en Etherscan et que vous avez quelque chose à apporter, contactez-nous.**

---

![](https://lh3.googleusercontent.com/4Ov6KyZOXXKLhn3ia1GsHXTlqJrJufMyscsMjjs8Ndd7OF6aVv6ULbfwodnZRZN_00m-iF4Bd3IZgCy4_z29XT8544n1sPjSd3COIRottpQgTgZ-1eF9jcJ75U6bBoveI6cSlg5g)

**Jugement Dernier :**

Qui est à blâmer ?

A la lumière de nos analyses, **nous pouvons dire que ce ne sont pas les auditeurs**, eux qui ont accompli consciencieusement leur [tâche](https://solidity.finance/audits/CP3R/) en veillant à ce que Compounder Finance reste à l'abri des attaques externes, tout en exprimant leurs préoccupations dans leur [rapport d'audit](https://solidity.finance/audits/CP3R/) et sur le [chat Telegram](https://solidity.finance/audits/CP3R/ChatLogs.pdf).

Peut-être auraient-ils pu exprimer leurs préoccupations avec un peu plus de véhémence, mais, en fin de compte, la responsabilité ultime incombera toujours au déposant.

Compouder.finance a utilisé un timelock comme élément censé prouver qu’ils ne feront pas de rug pull. Nous savons que cette méthode n’est pas digne de confiance. Si elle est employée, un système ou un dashboard d’alerte automatique se doit d’être mis en place pour monitorer les transactions à cette adresse.

24 heures ne semblent pas être assez pour donner une mise en garde suffisante aux utilisateurs pour pouvoir retirer leurs fonds. 

**Tous les projets avec des fondateurs anonymes ne sont pas des scams. Cette industrie toute entière a été fondée par des anonymes.**

Toutefois, presque tous les scams sont des projets avec des fondateurs anonymes. En tant que communauté, nous devons nous méfier de ces projets ; et tout particulièrement de ceux qui utilisent des sources de fonds intraçables comme Tornado.cash.

**La simple existence d'un rapport d'audit n'est pas suffisante pour assurer la sécurité ou la légitimité d'un projet**. Les audits se concentrent souvent sur les risques liés aux assaillants externes plus qu'à ceux internes - c'est peut-être quelque chose que les auditeurs devraient améliorer. 

Même avec des audits, des timelocks et des burn de clés, les déposants sont toujours à la merci d’autres utilisateurs, qui peuvent à tout moment dumper d’énormes quantité de tokens sur le marché.

![](https://lh5.googleusercontent.com/m44dt8mlCqX_pt-Pm7xDUEJJFvZ78tpUndfyCPqpOfsz40B0i8siXxY_TnFHZIati3P8IPlKtrsn4urG_lCY66X5hRagresLo5uRqwIbuDpkHW4-2C0ar1TOG7lqrpLvBCFK6MlF)

**Solidity.Finance : la déclaration officielle**

_L’équipe de Compounder a échangé les Strategy contracts sûrs et audités et les a remplacés avec des “Evil Strategy” contracts malicieux qui lui ont permis de voler les fonds de ses utilisateurs. Ils l'ont fait grâce à un timelock public, bien que clairement non monitoré, de 24 heures._

_Ce problème de contrôle centralisé par l'équipe de C3PR a été soulevé dans notre rapport d'audit et nos discussions avec leur équipe. L’équipe a le pouvoir de mettre à jour les strategy pools et l’ont fait ici avec beaucoup de malveillance afin de voler les fonds de leurs utilisateurs. Dans un souci de transparence, n’importe qui peut aller regarder l’historique de notre chat avec l’équipe de C3PR [ici](https://solidity.finance/audits/CP3R/ChatLogs.pdf)._

_Historiquement, nos audits se sont concentrés sur les risques liés aux attaques externes sur les projets, avec quelques discussions sur les risques posés par les équipes de projet comme nous l'avons fait ici. Nous allons nous servir de cette expérience malheureuse comme une opportunité pour apprendre, et aller de l’avant nous fournira d’avantages de détails solides dans un langage plus aisé à comprendre sur les risques découlant du contrôle des développeurs._

![](https://lh4.googleusercontent.com/9YXkVrtF4HWEpH_Wyf9N7T6ttzQGR7m-Dfg5At40sFJV4Rz0FbF_7FLEn_E5SM2D6HSeG7iymcg7T9DSLJkBP8SSCL0EuTWdiia6nnGhXD1vy-4ChPhbQh_seYfFHXRb94Wh1ILc)

Nous savons tous que nous devrions être capable de lire des smart contracts avant d’investir, mais la barrière de connaissances requise est élevée. Tout le monde ne sait pas quoi rechercher et ceux qui le font ne sont pas incités à partager leurs découvertes.

Dans le cas de C3PR, les utilisateurs qui avaient écouté avaient conscience du danger depuis le début, et le code qui a permis le rug pull a toujours été là.

Malgré cela, plus de 12,000,000$ ont été accumulés dans le contrat, pour ce que l’on peut qualifier dorénavant de l’un des plus gros rug pulls de tous les temps.

![](https://lh5.googleusercontent.com/5GlWMNDDXxJnsVsr0MxTgGKLmHwwlEjF7ufbN7LefUMdNaGsPDSCExLRHjavO4Vg4lQkR_wzRNF4jFxOqH6v4BsMmFUS7UXF_wMyR8S1xdjGVloDBVwR-bS6EZ1bBnPDFtXDvdMt)
